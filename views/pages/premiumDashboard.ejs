<%- include('../partials/header') %>

<h2>Premium Dashboard</h2>
<p>Welcome, <%= user.name %>! Manage and customize your AI experience.</p>

<!-- AI Question Generator Section -->
<h3>AI Question Generator</h3>
<label for="numQuestions">Number of Questions:</label>
<input type="number" id="numQuestions" min="1" max="50" value="10">
<button onclick="setQuestionCount()">Save</button>

<script>
function setQuestionCount() {
    let count = document.getElementById("numQuestions").value;
    localStorage.setItem("premiumQuestionCount", count);
    alert("Question count saved!");
}
</script>

<!-- Question Analytics Section -->
<h3>📊 Question Analytics</h3>
<p>Total Questions Generated: <%= analytics.totalQuestions %></p>
<p>Total Study Sessions: <%= analytics.sessions %></p>

<!-- Question History Section -->
<h3>📜 Question History</h3>
<ul>
    <% questionHistory.forEach(q => { %>
        <li><%= q.text %> - <%= q.numQuestions %> Questions (<%= q.date %>)</li>
    <% }) %>
</ul>

<!-- Widget Customization Section -->
<h3>🎨 Customize Widget</h3>
<label for="theme">Widget Theme:</label>
<select id="theme" onchange="updateSettings()">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
</select>

<!-- AI Personalization Section -->
<h3>🛠 AI Personalization</h3>
<label for="difficulty">AI Difficulty:</label>
<select id="difficulty" onchange="updateSettings()">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
</select>

<script>
async function updateSettings() {
    let theme = document.getElementById("theme").value;
    let difficulty = document.getElementById("difficulty").value;
    
    await fetch("/api/premium/update-settings", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ widgetTheme: theme, aiSettings: { difficulty } })
    });

    alert("Settings updated!");
}
</script>

<h3>📖 AI-Generated Flashcards</h3>
<div id="flashcard-container"></div>

<script src="/js/flashcards.js"></script>


<!-- Study Leaderboard Section -->
<h3>🏆 Study Leaderboard</h3>
<ul>
    <% leaderboard.forEach(user => { %>
        <li><%= user.name %> - <%= user["questionHistory.length"] %> Sessions</li>
    <% }) %>
</ul>

<!-- AI Study Recommendations Section -->
<h3>📚 AI Study Recommendations</h3>
<ul id="study-recommendations"></ul>

<script>
async function fetchRecommendations() {
    const response = await fetch("/api/recommendations");
    const data = await response.json();
    document.getElementById("study-recommendations").innerHTML = data.recommendations.map(r => `<li>${r}</li>`).join("");
}

fetchRecommendations();
</script>

<%- include('../partials/footer') %>
